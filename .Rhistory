setwd("C:/Users/Luka/Documents/EM")
use_git()
library(devtools)
library(roxygen2)
library(testthat)
library(knitr)
setwd("C:/Users/Luka/EM")
library(devtools)
library(roxygen2)
library(testthat)
library(knitr)
use_r("plot2density")
set.seed(1)
# napravicemo histogram uzorka iz iz nepoznate eksponencijalne raspodele
h <- hist(rexp(1000, rate = rexp(1, 0.1)))
dmix <- function(x, mi1, mi2) {
0.3 * dnorm(x, mi1, 1) +
0.7 * dnorm(x, mi2, 1)
}
# Uzmemo konkretne vrednosti m_1 = -1 i m_2 = 3
curve(dmix(x, -1, 3), xlim = c(-10, 10))
rmix <- function(n) {
u <- runif(n)
(u < 0.3) * rnorm(n, -1) +
(u >= 0.3) * rnorm(n, 3)
}
curve(dmix(x, -1, 3), xlim = c(-10, 10))
lines(density(rmix(100000)), col="green")
uzorak <- rmix(1000)
curve(dnorm(x, -1, 1), xlim = c(-10, 10))
lines(density(dnorm(x,3,1)), col="green")
plot2density <- function(df, split) {
# Histogram with density plot
ggplot(df, aes(x=weight)) +
geom_histogram(aes(y=..density..), colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.5,
position="identity")+
geom_density(alpha=.2)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
set.seed(1)
m_1<-1
m_2<-3
df <- data.frame(
# sex=factor(rep(c("F", "M"), each=200))
sex=factor(rep(c("F", "M"), each=200)),
weight=round(c(rnorm(200, mean=m_1, sd=1),
rnorm(200, mean=m_2, sd=1)))
)
plot2density <- function(df, split) {
# Histogram with density plot
ggplot(df, aes(x=weight)) +
geom_histogram(aes(y=..density..), colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.5,
position="identity")+
geom_density(alpha=.2)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
plot2density(df,split)
library(ggplot2)
plot2density <- function(df, split) {
# Histogram with density plot
ggplot(df, aes(x=weight)) +
geom_histogram(aes(y=..density..), colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.5,
position="identity")+
geom_density(alpha=.2)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
plot2density(df,split)
library(plyr)
install.package(plyr)
library(dplyr)
mu <- ddply(df, "sex", summarise, grp.mean=mean(weight))
head(mu)
install.packages("plyr")
library(dplyr)
mu <- ddply(df, "sex", summarise, grp.mean=mean(weight))
head(mu)
ddply(df, "sex", summarise, grp.mean=mean(weight))
library(plyr)
detach("package:dplyr", unload=TRUE)
detach("package:plyr", unload=TRUE)
library(plyr)
mu <- ddply(df, "sex", summarise, grp.mean=mean(weight))
head(mu)
plot2density <- function(df, split) {
# Histogram with density plot
ggplot(df, aes(x=weight)) +
geom_histogram(aes(y=..density..), colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.5,
position="identity")+
geom_density(alpha=.2)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
plot2density(df,split)
ggplot(df, aes(x=weight)) +
#geom_histogram(aes(y=..density..), colour="black", fill="white")+
#geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.2,
position="identity")+
geom_density(alpha=.8)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
ggplot(df, aes(x=weight)) +
geom_histogram(aes(y=..density..), colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.2,
position="identity")+
geom_density(alpha=.8)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
ggplot(df, aes(x=weight)) +
geom_histogram(aes(y=..density..), colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.2,
position="identity")+
geom_density(alpha=.8)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
plot2density <- function(df, split) {
# Histogram with density plot
ggplot(df, aes(x=weight)) +
geom_histogram(aes(y=..density..), colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.2,
position="identity")+
geom_density(alpha=.8)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
plot2density(df,split)
df <- function(m_1, m_2) {
data.frame(
sex=factor(rep(c("F", "M"), each=200))
sex=factor(rep(c("F", "M"), each=200)),
weight=round(c(rnorm(200, mean=m_1, sd=1),
rnorm(200, mean=m_2, sd=1)))
)
}
df <- function(m_1, m_2) {
data.frame(
sex=factor(rep(c("F", "M"), each=200)),
weight=round(c(rnorm(200, mean=m_1, sd=1),
rnorm(200, mean=m_2, sd=1)))
)
}
m_1<-1
m_2<-3
df(m_1,m_2)
mu <- ddply(df, "sex", summarise, grp.mean=mean(weight))
head(mu)
df <- function(m_1, m_2) {
data.frame(
sex=factor(rep(c("F", "M"), each=200)),
weight=round(c(rnorm(200, mean=m_1, sd=1),
rnorm(200, mean=m_2, sd=1)))
)
}
df
mu <- ddply(df, "sex", summarise, grp.mean=mean(weight))
head(mu)
plot2density <- function(df, split) {
# Histogram with density plot
ggplot(df, aes(x=weight)) +
geom_histogram(aes(y=..density..), colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.2,
position="identity")+
geom_density(alpha=.8)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
plot2density(df,split)
rlang::last_error()
m_1<-1
m_2<-3
df <- data.frame(
sex=factor(rep(c("F", "M"), each=200)),
weight=round(c(rnorm(200, mean=m_1, sd=1),
rnorm(200, mean=m_2, sd=1)))
)
#detach("package:dplyr", unload=TRUE)
#install.packages("plyr")
#library(plyr)
mu <- ddply(df, "sex", summarise, grp.mean=mean(weight))
head(mu)
plot2density <- function(df, split) {
# Histogram with density plot
ggplot(df, aes(x=weight)) +
geom_histogram(aes(y=..density..), colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.2,
position="identity")+
geom_density(alpha=.8)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
plot2density(df,split)
plot2density(df,split)
mu<-0
df <- data.frame(
sex=factor(rep(c("F", "M"), each=200)),
weight=round(c(rnorm(200, mean=m_1, sd=1),
rnorm(200, mean=m_2, sd=1)))
)
plot2density <- function(df, split) {
mu <- ddply(df, "sex", summarise, grp.mean=mean(weight))
# Histogram with density plot
ggplot(df, aes(x=weight)) +
geom_histogram(aes(y=..density..), colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")
# Color by groups
# Change density plot fill colors by groups
p<-ggplot(df, aes(x=weight, color=sex, fill=sex)) +
# Use semi-transparent fill
geom_histogram(aes(y=..density..), alpha=0.2,
position="identity")+
geom_density(alpha=.8)
# Add mean lines
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")
}
plot2density(df,split)
